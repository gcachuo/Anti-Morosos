<form>
    <h3>Publicar una queja</h3>
    <div class="row pb-2">
        <div class="col">
            <input type="text" id="txtMoroso" class="form-control" placeholder="Nombre">
        </div>
    </div>
    <div class="row pb-2">
        <div class="col">
            <textarea title="Queja" name="queja" id="txtQueja" class="form-control" placeholder="Mensaje"></textarea>
        </div>
    </div>
    <div class="row pb-3">
        <div class="col offset-7">
            <span onclick="publish()" class="btn btn-block btn-primary">Publicar</span>
        </div>
    </div>
</form>
<div id="alertSignIn" style="display: none;" class="alert alert-danger" role="alert">
    Inicie sesi√≥n para publicar una queja.
</div>
<div class="container-fluid" id="quejas">
    <div id="alertNoPosts" class="alert alert-primary" role="alert">
        No hay quejas publicadas.
    </div>
</div>
<script>
    $(function () {
        if (localStorage.getItem('user.id')) {
            $(".logged").show();
            $(".noUser").hide();
            navigate('dashboard.html');
        }
        else {
            $(".logged").hide();
            $(".noUser").show();
            navigate('sign-in.html');
        }
    });

    function publish() {
        const data = {
            mensaje: $("#txtQueja").val(),
            moroso: $("#txtMoroso").val(),
            usuario: {
                id: localStorage.getItem('user.id'),
                name: localStorage.getItem('user.name')
            }
        };

        if (!data.moroso) {
            alert('Ingrese un nombre');
            return;
        }
        if (!data.mensaje) {
            alert('Ingrese un mensaje');
            return;
        }

        $.get(`templates/queja.html`, function (template) {
            var rendered = Mustache.render(template, data);
            $("#quejas").prepend(rendered);

            $("#txtQueja").val('');
            $("#txtMoroso").val('');

            $("#alertNoPosts").hide();
        });
    }
</script>